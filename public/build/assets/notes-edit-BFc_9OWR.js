document.addEventListener("DOMContentLoaded",function(){console.log("Notes edit script loaded");const i=Quill.import("formats/font"),l=["sans-serif","serif","monospace","roboto","playfair","opensans","lato","montserrat","poppins","raleway"];i.whitelist=l,i.default="sans-serif",Quill.register(i,!0);const t=new Quill("#editor",{theme:"snow",placeholder:"Введите текст заметки...",modules:{toolbar:[[{header:[1,2,3,4,5,6,!1]}],["bold","italic","underline","strike"],["blockquote","code-block"],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{color:[]},{background:[]}],[{font:l}],[{align:[]}],["link"],["clean"]]}});console.log("Quill initialized for editing");const o=document.querySelector("#content");if(o&&o.value)try{t.root.innerHTML=o.value,console.log("Existing content loaded")}catch(e){console.error("Error loading content:",e)}delete t.keyboard.bindings.Enter,t.keyboard.addBinding({key:"Enter",handler:function(e,n){const s=t.getFormat(e.index);return this.quill.insertText(e.index,`
`),this.quill.setSelection(e.index+1),s.font&&setTimeout(()=>{this.quill.getSelection()&&this.quill.format("font",s.font)},0),!1}});const r=document.getElementById("note-form");if(!r){console.error("Note form not found");return}r.addEventListener("submit",function(e){e.preventDefault(),console.log("Submit event triggered");const n=t.root.innerHTML.trim();o.value=n,(n===""||n==="<p><br></p>")&&(o.value="<p>Пустая заметка</p>"),console.log("Content updated, submitting form"),this.submit()})});
