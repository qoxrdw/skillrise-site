document.addEventListener("DOMContentLoaded",function(){console.log("Notes edit script loaded");const i=Quill.import("formats/font"),r=Quill.import("formats/size"),l=["sans-serif","serif","roboto","opensans","montserrat","raleway","georgia","verdana","spectral","merriweather"],s=["8px","9px","10px","11px","12px","14px","16px","18px","20px","22px","24px","26px","28px","36px","48px","72px"];i.whitelist=l,i.default="sans-serif",r.whitelist=s,Quill.register(i,!0),Quill.register(r,!0);const t=new Quill("#editor",{theme:"snow",placeholder:"Введите текст заметки...",modules:{toolbar:[[{header:[1,2,3,4,5,6,!1]}],[{size:s}],[{font:l}],["bold","italic","underline","strike"],["blockquote","code-block"],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{color:[]},{background:[]}],[{align:[]}],["link"],["clean"]]}});console.log("Quill initialized for editing");const o=document.querySelector("#content");if(o&&o.value)try{t.root.innerHTML=o.value,console.log("Existing content loaded")}catch(e){console.error("Error loading content:",e)}delete t.keyboard.bindings.Enter,t.keyboard.addBinding({key:"Enter",handler:function(e,n){const c=t.getFormat(e.index);return this.quill.insertText(e.index,`
`),this.quill.setSelection(e.index+1),c.font&&setTimeout(()=>{this.quill.getSelection()&&this.quill.format("font",c.font)},0),!1}});const d=document.getElementById("note-form");if(!d){console.error("Note form not found");return}d.addEventListener("submit",function(e){e.preventDefault(),console.log("Submit event triggered");const n=t.root.innerHTML.trim();o.value=n,(n===""||n==="<p><br></p>")&&(o.value="<p>Пустая заметка</p>"),console.log("Content updated, submitting form"),this.submit()})});
